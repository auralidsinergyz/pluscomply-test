!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function e(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(t))}function t(e){var t=e.target,r=$(t);if(!r.is("[type=submit],[type=image]")){var a=r.closest("[type=submit]");if(0===a.length)return;t=a[0]}var n=this;if(n.clk=t,"image"==t.type)if(void 0!==e.offsetX)n.clk_x=e.offsetX,n.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var i=r.offset();n.clk_x=e.pageX-i.left,n.clk_y=e.pageY-i.top}else n.clk_x=e.pageX-t.offsetLeft,n.clk_y=e.pageY-t.offsetTop;setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},100)}function r(){if($.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var a={};a.fileapi=void 0!==$("<input type='file'/>").get(0).files,a.formdata=void 0!==window.FormData;var n=!!$.fn.prop;$.fn.attr2=function(){if(!n)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(e){function t(t){var r=$.param(t,e.traditional).split("&"),a=r.length,n=[],i,o;for(i=0;a>i;i++)r[i]=r[i].replace(/\+/g," "),o=r[i].split("="),n.push([decodeURIComponent(o[0]),decodeURIComponent(o[1])]);return n}function i(r){for(var a=new FormData,n=0;n<r.length;n++)a.append(r[n].name,r[n].value);if(e.extraData){var i=t(e.extraData);for(n=0;n<i.length;n++)i[n]&&a.append(i[n][0],i[n][1])}e.data=null;var o=$.extend(!0,{},$.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:s||"POST"});e.uploadProgress&&(o.xhr=function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){var r=0,a=t.loaded||t.position,n=t.total;t.lengthComputable&&(r=Math.ceil(a/n*100)),e.uploadProgress(t,a,n,r)},!1),t}),o.data=null;var u=o.beforeSend;return o.beforeSend=function(t,r){e.formData?r.data=e.formData:r.data=a,u&&u.call(this,t,r)},$.ajax(o)}function o(t){function a(e){var t=null;try{e.contentWindow&&(t=e.contentWindow.document)}catch(a){r("cannot get iframe.contentWindow document: "+a)}if(t)return t;try{t=e.contentDocument?e.contentDocument:e.document}catch(a){r("cannot get iframe.contentDocument: "+a),t=e.document}return t}function i(){function e(){try{var t=a(g).readyState;r("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(n){r("Server abort: ",n," (",n.name,")"),o(D),j&&clearTimeout(j),j=void 0}}var t=l.attr2("target"),n=l.attr2("action"),i="multipart/form-data",c=l.attr("enctype")||l.attr("encoding")||i;u.setAttribute("target",h),s&&!/post/i.test(s)||u.setAttribute("method","POST"),n!=d.url&&u.setAttribute("action",d.url),d.skipEncodingOverride||s&&!/post/i.test(s)||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),d.timeout&&(j=setTimeout(function(){T=!0,o(S)},d.timeout));var f=[];try{if(d.extraData)for(var m in d.extraData)d.extraData.hasOwnProperty(m)&&($.isPlainObject(d.extraData[m])&&d.extraData[m].hasOwnProperty("name")&&d.extraData[m].hasOwnProperty("value")?f.push($('<input type="hidden" name="'+d.extraData[m].name+'">').val(d.extraData[m].value).appendTo(u)[0]):f.push($('<input type="hidden" name="'+m+'">').val(d.extraData[m]).appendTo(u)[0]));d.iframeTarget||v.appendTo("body"),g.attachEvent?g.attachEvent("onload",o):g.addEventListener("load",o,!1),setTimeout(e,15);try{u.submit()}catch(p){var x=document.createElement("form").submit;x.apply(u)}}finally{u.setAttribute("action",n),u.setAttribute("enctype",c),t?u.setAttribute("target",t):l.removeAttr("target"),$(f).remove()}}function o(e){if(!x.aborted&&!F){if(E=a(g),E||(r("cannot access response document"),e=D),e===S&&x)return x.abort("timeout"),void w.reject(x,"timeout");if(e==D&&x)return x.abort("server abort"),void w.reject(x,"error","server abort");if(E&&E.location.href!=d.iframeSrc||T){g.detachEvent?g.detachEvent("onload",o):g.removeEventListener("load",o,!1);var t="success",n;try{if(T)throw"timeout";var i="xml"==d.dataType||E.XMLDocument||$.isXMLDoc(E);if(r("isXml="+i),!i&&window.opera&&(null===E.body||!E.body.innerHTML)&&--M)return r("requeing onLoad callback, DOM not available"),void setTimeout(o,250);var s=E.body?E.body:E.documentElement;x.responseText=s?s.innerHTML:null,x.responseXML=E.XMLDocument?E.XMLDocument:E,i&&(d.dataType="xml"),x.getResponseHeader=function(e){var t={"content-type":d.dataType};return t[e.toLowerCase()]},s&&(x.status=Number(s.getAttribute("status"))||x.status,x.statusText=s.getAttribute("statusText")||x.statusText);var u=(d.dataType||"").toLowerCase(),c=/(json|script|text)/.test(u);if(c||d.textarea){var l=E.getElementsByTagName("textarea")[0];if(l)x.responseText=l.value,x.status=Number(l.getAttribute("status"))||x.status,x.statusText=l.getAttribute("statusText")||x.statusText;else if(c){var f=E.getElementsByTagName("pre")[0],m=E.getElementsByTagName("body")[0];f?x.responseText=f.textContent?f.textContent:f.innerText:m&&(x.responseText=m.textContent?m.textContent:m.innerText)}}else"xml"==u&&!x.responseXML&&x.responseText&&(x.responseXML=O(x.responseText));try{L=C(x,u,d)}catch(h){t="parsererror",x.error=n=h||t}}catch(h){r("error caught: ",h),t="error",x.error=n=h||t}x.aborted&&(r("upload aborted"),t=null),x.status&&(t=x.status>=200&&x.status<300||304===x.status?"success":"error"),"success"===t?(d.success&&d.success.call(d.context,L,"success",x),w.resolve(x.responseText,"success",x),p&&$.event.trigger("ajaxSuccess",[x,d])):t&&(void 0===n&&(n=x.statusText),d.error&&d.error.call(d.context,x,t,n),w.reject(x,"error",n),p&&$.event.trigger("ajaxError",[x,d,n])),p&&$.event.trigger("ajaxComplete",[x,d]),p&&!--$.active&&$.event.trigger("ajaxStop"),d.complete&&d.complete.call(d.context,x,t),F=!0,d.timeout&&clearTimeout(j),setTimeout(function(){d.iframeTarget?v.attr("src",d.iframeSrc):v.remove(),x.responseXML=null},100)}}}var u=l[0],c,f,d,p,h,v,g,x,y,b,T,j,w=$.Deferred();if(w.abort=function(e){x.abort(e)},t)for(f=0;f<m.length;f++)c=$(m[f]),n?c.prop("disabled",!1):c.removeAttr("disabled");if(d=$.extend(!0,{},$.ajaxSettings,e),d.context=d.context||d,h="jqFormIO"+(new Date).getTime(),d.iframeTarget?(v=$(d.iframeTarget),b=v.attr2("name"),b?h=b:v.attr2("name",h)):(v=$('<iframe name="'+h+'" src="'+d.iframeSrc+'" />'),v.css({position:"absolute",top:"-1000px",left:"-1000px"})),g=v[0],x={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";r("aborting upload... "+t),this.aborted=1;try{g.contentWindow.document.execCommand&&g.contentWindow.document.execCommand("Stop")}catch(a){}v.attr("src",d.iframeSrc),x.error=t,d.error&&d.error.call(d.context,x,t,e),p&&$.event.trigger("ajaxError",[x,d,t]),d.complete&&d.complete.call(d.context,x,t)}},p=d.global,p&&0===$.active++&&$.event.trigger("ajaxStart"),p&&$.event.trigger("ajaxSend",[x,d]),d.beforeSend&&d.beforeSend.call(d.context,x,d)===!1)return d.global&&$.active--,w.reject(),w;if(x.aborted)return w.reject(),w;y=u.clk,y&&(b=y.name,b&&!y.disabled&&(d.extraData=d.extraData||{},d.extraData[b]=y.value,"image"==y.type&&(d.extraData[b+".x"]=u.clk_x,d.extraData[b+".y"]=u.clk_y)));var S=1,D=2,k=$("meta[name=csrf-token]").attr("content"),A=$("meta[name=csrf-param]").attr("content");A&&k&&(d.extraData=d.extraData||{},d.extraData[A]=k),d.forceSync?i():setTimeout(i,10);var L,E,M=50,F,O=$.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},X=$.parseJSON||function(e){return window.eval("("+e+")")},C=function(e,t,r){var a=e.getResponseHeader("content-type")||"",n="xml"===t||!t&&a.indexOf("xml")>=0,i=n?e.responseXML:e.responseText;return n&&"parsererror"===i.documentElement.nodeName&&$.error&&$.error("parsererror"),r&&r.dataFilter&&(i=r.dataFilter(i,t)),"string"==typeof i&&("json"===t||!t&&a.indexOf("json")>=0?i=X(i):("script"===t||!t&&a.indexOf("javascript")>=0)&&$.globalEval(i)),i};return w}if(!this.length)return r("ajaxSubmit: skipping submit process - no element selected"),this;var s,u,c,l=this;"function"==typeof e?e={success:e}:void 0===e&&(e={}),s=e.type||this.attr2("method"),u=e.url||this.attr2("action"),c="string"==typeof u?$.trim(u):"",c=c||window.location.href||"",c&&(c=(c.match(/^([^#]+)/)||[])[1]),e=$.extend(!0,{url:c,success:$.ajaxSettings.success,type:s||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var f={};if(this.trigger("form-pre-serialize",[this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&e.beforeSerialize(this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var d=e.traditional;void 0===d&&(d=$.ajaxSettings.traditional);var m=[],p,h=this.formToArray(e.semantic,m);if(e.data&&(e.extraData=e.data,p=$.param(e.data,d)),e.beforeSubmit&&e.beforeSubmit(h,this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[h,this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=$.param(h,d);p&&(v=v?v+"&"+p:p),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+v,e.data=null):e.data=v;var g=[];if(e.resetForm&&g.push(function(){l.resetForm()}),e.clearForm&&g.push(function(){l.clearForm(e.includeHidden)}),!e.dataType&&e.target){var x=e.success||function(){};g.push(function(t){var r=e.replaceTarget?"replaceWith":"html";$(e.target)[r](t).each(x,arguments)})}else e.success&&g.push(e.success);if(e.success=function(t,r,a){for(var n=e.context||this,i=0,o=g.length;o>i;i++)g[i].apply(n,[t,r,a||l,l])},e.error){var y=e.error;e.error=function(t,r,a){var n=e.context||this;y.apply(n,[t,r,a,l])}}if(e.complete){var b=e.complete;e.complete=function(t,r){var a=e.context||this;b.apply(a,[t,r,l])}}var T=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),j=T.length>0,w="multipart/form-data",S=l.attr("enctype")==w||l.attr("encoding")==w,D=a.fileapi&&a.formdata;r("fileAPI :"+D);var k=(j||S)&&!D,A;e.iframe!==!1&&(e.iframe||k)?e.closeKeepAlive?$.get(e.closeKeepAlive,function(){A=o(h)}):A=o(h):A=(j||S)&&D?i(h):$.ajax(e),l.removeData("jqxhr").data("jqxhr",A);for(var L=0;L<m.length;L++)m[L]=null;return this.trigger("form-submit-notify",[this,e]),this},$.fn.ajaxForm=function(a){if(a=a||{},a.delegation=a.delegation&&$.isFunction($.fn.on),!a.delegation&&0===this.length){var n={s:this.selector,c:this.context};return!$.isReady&&n.s?(r("DOM not ready, queuing ajaxForm"),$(function(){$(n.s,n.c).ajaxForm(a)}),this):(r("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return a.delegation?($(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,t).on("submit.form-plugin",this.selector,a,e).on("click.form-plugin",this.selector,a,t),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,e).bind("click.form-plugin",a,t)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(e,t){var r=[];if(0===this.length)return r;var n=this[0],i=this.attr("id"),o=e?n.getElementsByTagName("*"):n.elements,s;if(o&&!/MSIE [678]/.test(navigator.userAgent)&&(o=$(o).get()),i&&(s=$(':input[form="'+i+'"]').get(),s.length&&(o=(o||[]).concat(s))),!o||!o.length)return r;var u,c,l,f,d,m,p;for(u=0,m=o.length;m>u;u++)if(d=o[u],l=d.name,l&&!d.disabled)if(e&&n.clk&&"image"==d.type)n.clk==d&&(r.push({name:l,value:$(d).val(),type:d.type}),r.push({name:l+".x",value:n.clk_x},{name:l+".y",value:n.clk_y}));else if(f=$.fieldValue(d,!0),f&&f.constructor==Array)for(t&&t.push(d),c=0,p=f.length;p>c;c++)r.push({name:l,value:f[c]});else if(a.fileapi&&"file"==d.type){t&&t.push(d);var h=d.files;if(h.length)for(c=0;c<h.length;c++)r.push({name:l,value:h[c],type:d.type});else r.push({name:l,value:"",type:d.type})}else null!==f&&"undefined"!=typeof f&&(t&&t.push(d),r.push({name:l,value:f,type:d.type,required:d.required}));if(!e&&n.clk){var v=$(n.clk),g=v[0];l=g.name,l&&!g.disabled&&"image"==g.type&&(r.push({name:l,value:v.val()}),r.push({name:l+".x",value:n.clk_x},{name:l+".y",value:n.clk_y}))}return r},$.fn.formSerialize=function(e){return $.param(this.formToArray(e))},$.fn.fieldSerialize=function(e){var t=[];return this.each(function(){var r=this.name;if(r){var a=$.fieldValue(this,e);if(a&&a.constructor==Array)for(var n=0,i=a.length;i>n;n++)t.push({name:r,value:a[n]});else null!==a&&"undefined"!=typeof a&&t.push({name:this.name,value:a})}}),$.param(t)},$.fn.fieldValue=function(e){for(var t=[],r=0,a=this.length;a>r;r++){var n=this[r],i=$.fieldValue(n,e);null===i||"undefined"==typeof i||i.constructor==Array&&!i.length||(i.constructor==Array?$.merge(t,i):t.push(i))}return t},$.fieldValue=function(e,t){var r=e.name,a=e.type,n=e.tagName.toLowerCase();if(void 0===t&&(t=!0),t&&(!r||e.disabled||"reset"==a||"button"==a||("checkbox"==a||"radio"==a)&&!e.checked||("submit"==a||"image"==a)&&e.form&&e.form.clk!=e||"select"==n&&-1==e.selectedIndex))return null;if("select"==n){var i=e.selectedIndex;if(0>i)return null;for(var o=[],s=e.options,u="select-one"==a,c=u?i+1:s.length,l=u?i:0;c>l;l++){var f=s[l];if(f.selected){var d=f.value;if(d||(d=f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value),u)return d;o.push(d)}}return o}return $(e).val()},$.fn.clearForm=function(e){return this.each(function(){$("input,select,textarea",this).clearFields(e)})},$.fn.clearFields=$.fn.clearInputs=function(e){var t=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,a=this.tagName.toLowerCase();t.test(r)||"textarea"==a?this.value="":"checkbox"==r||"radio"==r?this.checked=!1:"select"==a?this.selectedIndex=-1:"file"==r?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):e&&(e===!0&&/hidden/.test(r)||"string"==typeof e&&$(this).is(e))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},$.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=e;else if("option"==this.tagName.toLowerCase()){var r=$(this).parent("select");e&&r[0]&&"select-one"==r[0].type&&r.find("option").selected(!1),this.selected=e}})},$.fn.ajaxSubmit.debug=!1});