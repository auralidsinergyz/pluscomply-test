{"version":3,"file":"admin.tincan.report.tab.min.js","sources":["admin.tincan.report.tab.min.js"],"sourcesContent":["/**\n * @package Uncanny TinCan API\n * @author Uncanny Owl\n * @version 1.0.0\n */\n\njQuery( document ).ready( function($) {\n\t// Per Page\n\t$( '#tincan-filters-per_page select' ).change( function() {\n\t\tconsole.log('changed per page select');\n\t\tvar value = $(this).find( 'option:selected' ).val();\n\n\t\tinsertParam( 'per_page', value );\n\t});\n\n\t// <!-- Change Date Range Type\n\t$( '#tincan-filters-top #tc_filter_date_range_last' ).click( function() {\n\t\t$( '#tincan-filters-top input[name=\"tc_filter_date_range\"][value=\"last\"]' ).click();\n\t});\n\n\t$( '#tincan-filters-top input[name=\"tc_filter_start\"], #tincan-filters-top input[name=\"tc_filter_end\"]' ).click( function() {\n\t\t$( '#tincan-filters-top input[name=\"tc_filter_date_range\"][value=\"from\"]' ).click();\n\t});\n\n\t$( '#xapi-filters-top #tcx_filter_date_range_last' ).click( function() {\n\t\t$( '#xapi-filters-top input[name=\"tc_filter_date_range\"][value=\"last\"]' ).click();\n\t});\n\n\t$( '#xapi-filters-top input[name=\"tc_filter_start\"], #xapi-filters-top input[name=\"tc_filter_end\"]' ).click( function() {\n\t\t$( '#xapi-filters-top input[name=\"tc_filter_date_range\"][value=\"from\"]' ).click();\n\t});\n\t// Change Date Range Type -->\n\n\t// CSV Export\n\t$( '#do_tc_export_csv' ).click( function( e ) {\n\t\tvar fields = [ 'tc_filter_group', 'tc_filter_user', 'tc_filter_course', 'tc_filter_lesson', 'tc_filter_module', 'tc_filter_action', 'tc_filter_date_range', 'tc_filter_date_range_last', 'tc_filter_start', 'tc_filter_end' ];\n\n\t\t$.each( fields, function( index, value ) {\n\t\t\tvar value_top = $( '#tincan-filters-top [name=\"' + value + '\"]' ).val();\n\n\t\t\t$( '#tincan-filters-bottom [name=\"' + value + '\"]' ).val( value_top );\n\t\t});\n\n\t\tvar tc_filter_date_range = $( '#tincan-filters-top input[name=\"tc_filter_date_range\"]:checked' ).val();\n\n\t\tif ( typeof tc_filter_date_range != 'undefined' ) {\n\t\t\t$( '#tincan-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( tc_filter_date_range );\n\t\t} else {\n\t\t\t$( '#tincan-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( '' );\n\t\t}\n\t});\n\n    // CSV Export\n    $( '#do_tc_export_csv_xapi' ).click( function( e ) {\n        var fields = [ 'tc_filter_group', 'tc_filter_user', 'tc_filter_course', 'tc_filter_lesson', 'tc_filter_module', 'tc_filter_action', 'tc_filter_quiz', 'tc_filter_results', 'tc_filter_date_range', 'tc_filter_date_range_last', 'tc_filter_start', 'tc_filter_end' ];\n\n        $.each( fields, function( index, value ) {\n            var value_top = $( '#xapi-filters-top [name=\"' + value + '\"]' ).val();\n\n            $( '#xapi-filters-bottom [name=\"' + value + '\"]' ).val( value_top );\n        });\n\n        var tc_filter_date_range = $( '#xapi-filters-top input[name=\"tc_filter_date_range\"]:checked' ).val();\n\n        if ( typeof tc_filter_date_range != 'undefined' ) {\n            $( '#xapi-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( tc_filter_date_range );\n        } else {\n            $( '#xapi-filters-bottom input[name=\"tc_filter_date_range\"]' ).val( '' );\n        }\n    });\n\n\t// Ajax : Modules from Course\n\t$( '#tincan-filters-top select[name=\"tc_filter_course\"]' ).change( function() {\n\t\tif ( !$(this).val() ) {\n\t\t\tResetModules();\n\t\t\treturn;\n\t\t}\n\n\t\tvar data = {\n\t\t\t'action': 'GET_Modules',\n\t\t\t'tc_filter_course' : $( this ).val()\n\t\t};\n\n\t\t$.post( reportingApiSetup.ajaxurl, data, function( response ) {\n\t\t\t// Do Something\n\n\t\t\tResetModules();\n\t\t\t$( '#tincan-filters-top select[name=\"tc_filter_module\"]' ).append( response );\n\t\t});\n\t});\n\n\t// Ajax : Modules from Course\n\t$( '#xapi-filters-top select[name=\"tc_filter_course\"]' ).change( function() {\n\t\tif ( !$(this).val() ) {\n            ResetModulesXAPI();\n\t\t\treturn;\n\t\t}\n\n\t\tvar data = {\n\t\t\t'action': 'GET_Modules',\n            'type'  : 'quiz',\n\t\t\t'tc_filter_course' : $( this ).val()\n\t\t};\n\n\t\t$.post( reportingApiSetup.ajaxurl, data, function( response ) {\n\t\t\t// Do Something\n\n            ResetModulesXAPI();\n\t\t\t$( '#xapi-filters-top select[name=\"tc_filter_module\"]' ).append( response );\n\t\t});\n\t});\n\n\tif( reportingApiSetup.isAdmin == \"\" ) {\n        // Ajax : Modules from Course\n        $('#tincan-filters-top select[name=\"tc_filter_group\"]').change(function () {\n            if (!$(this).val()) {\n                ResetCourses();\n                return;\n            }\n\n            var data = {\n                'action': 'GET_Courses',\n                'tc_filter_group': $(this).val()\n            };\n\n            $.post(reportingApiSetup.ajaxurl, data, function (response) {\n                // Do Something\n\n                ResetCourses();\n                $('#tincan-filters-top select[name=\"tc_filter_course\"]').append(response);\n            });\n        });\n\n        // Ajax : Modules from Course\n        $('#xapi-filters-top select[name=\"tc_filter_group\"]').change(function () {\n            if (!$(this).val()) {\n                ResetCoursesXAPI();\n                return;\n            }\n\n            var data = {\n                'action': 'GET_Courses',\n                'type': 'quiz',\n                'tc_filter_group': $(this).val()\n            };\n\n            $.post(reportingApiSetup.ajaxurl, data, function (response) {\n                // Do Something\n\n                ResetCoursesXAPI();\n                $('#xapi-filters-top select[name=\"tc_filter_course\"]').append(response);\n            });\n        });\n    }\n\t// Change Sorting Indicator\n\t$( '.uo-admin-reporting-tab-single#tin-can table.wp-list-table thead th' ).each( function() {\n\t\tvar $indicator = $(this).find( '.sorting-indicator' );\n\n\t\tif ( $indicator.css( 'visibility' ) == 'hidden' ) {\n\t\t\t$indicator.addClass( 'double-headed-triangles' );\n\t\t}\n\t});\n\n\tfunction ResetModules() {\n\t\t$( '#tincan-filters-top select[name=\"tc_filter_module\"]' ).children().each( function (i) {\n\t\t\tif ( i !== 0 ) $(this).remove();\n\t\t});\n\t}\n\n\tfunction ResetModulesXAPI() {\n\t\t$( '#xapi-filters-top select[name=\"tc_filter_module\"]' ).children().each( function (i) {\n\t\t\tif ( i !== 0 ) $(this).remove();\n\t\t});\n\t}\n\n    function ResetCourses() {\n        $( '#tincan-filters-top select[name=\"tc_filter_course\"]' ).children().each( function (i) {\n            if ( i !== 0 ) $(this).remove();\n        });\n    }\n\n    function ResetCoursesXAPI() {\n        $( '#xapi-filters-top select[name=\"tc_filter_course\"]' ).children().each( function (i) {\n            if ( i !== 0 ) $(this).remove();\n        });\n    }\n\n\tfunction insertParam(key, value)\n\t{\n\t\tconsole.log('inserting param');\n\t\tconsole.log([key, value]);\n\t    key = encodeURI(key); value = encodeURI(value);\n\n\t    var kvp = document.location.search.substr(1).split('&');\n\n\t    var i=kvp.length; var x; while(i--)\n\t    {\n\t        x = kvp[i].split('=');\n\n\t        if (x[0]==key)\n\t        {\n\t            x[1] = value;\n\t            kvp[i] = x.join('=');\n\t            break;\n\t        }\n\t    }\n\n\t    if(i<0) {kvp[kvp.length] = [key,value].join('=');}\n\n\t    //this will reload the page, it's likely better to store this until finished\n\t    document.location.search = kvp.join('&');\n\t}\n\n    $(\"#tc_filter_quiz\").select2({\n        ajax: {\n            url: reportingApiSetup.ajaxurl,\n            dataType: 'json',\n            type: 'POST',\n            delay: 250,\n            data: function (params) {\n                return {\n                    q: params.term, // search term\n                    page: params.page,\n                    action: 'GET_Questions'\n                };\n            },\n\n            cache: true\n        },\n        placeholder: {\n            id: '1', // the value of the option\n            text: TincannyData.i18n.allQuestions\n        },\n        allowClear: true,\n        minimumInputLength: 1,\n        language: {\n            errorLoading: function() {\n                return TincannyData.i18n.dropdown.errorLoading\n            },\n            inputTooLong: function(e) {\n                var n = e.input.length - e.maximum;\n\n                if ( n == 1 ){\n                    return TincannyData.i18n.dropdown.inputTooLong.singular;\n                } else {\n                    return TincannyData.i18n.dropdown.inputTooLong.plural.replace( '%s', n );\n                }\n            },\n            inputTooShort: function(e) {\n                return TincannyData.i18n.dropdown.inputTooShort.replace( '%s', (e.minimum - e.input.length) );\n            },\n            loadingMore: function() {\n                return TincannyData.i18n.dropdown.loadingMore;\n            },\n            maximumSelected: function(e) {\n                if ( e.maximum == 1 ){\n                    return TincannyData.i18n.dropdown.maximumSelected.singular;\n                } else {\n                    return TincannyData.i18n.dropdown.maximumSelected.plural.replace( '%s', e.maximum );\n                }\n            },\n            noResults: function() {\n                return TincannyData.i18n.dropdown.noResults;\n            },\n            searching: function() {\n                return TincannyData.i18n.dropdown.searching;\n            },\n            removeAllItems: function() {\n                return TincannyData.i18n.dropdown.removeAllItems;\n            }\n        },\n    });\n\n});"],"names":["jQuery","document","ready","$","ResetModules","children","each","i","this","remove","ResetModulesXAPI","ResetCourses","ResetCoursesXAPI","change","console","log","key","value","encodeURI","x","kvp","location","search","substr","split","length","join","insertParam","find","val","click","e","index","value_top","tc_filter_date_range","data","action","tc_filter_course","post","reportingApiSetup","ajaxurl","response","append","type","isAdmin","tc_filter_group","$indicator","css","addClass","select2","ajax","url","dataType","delay","params","q","term","page","cache","placeholder","id","text","TincannyData","i18n","allQuestions","allowClear","minimumInputLength","language","errorLoading","dropdown","inputTooLong","n","input","maximum","singular","plural","replace","inputTooShort","minimum","loadingMore","maximumSelected","noResults","searching","removeAllItems"],"mappings":"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"}