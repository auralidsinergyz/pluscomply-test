!function(e){"use strict";function t(e){for(var t="",n=e.split(/\n/);n.length>3;){for(var a=3;a<n.length;a++)n[2]+="\n"+n[a];n.splice(3,n.length-3)}var o=0;if(!n[0].match(/\d+:\d+:\d+/)&&n[1].match(/\d+:\d+:\d+/)&&(t+=n[0].match(/\w+/)+"\n",o+=1),!n[o].match(/\d+:\d+:\d+/))return"";var r=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);return r?(t+=r[1]+":"+r[2]+":"+r[3]+"."+r[4]+" --> "+r[5]+":"+r[6]+":"+r[7]+"."+r[8]+"\n",n[o+=1]&&(t+=n[o]+"\n\n"),t):""}function n(e,n,a){var o;(o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){if(4==o.readyState&&200==o.status&&o.responseText){var r=function e(n){var a=n.replace(/\r+/g,""),o=(a=a.replace(/^\s+|\s+$/g,"")).split("\n\n"),r="";if(o.length>0){r+="WEBVTT\n\n";for(var s=0;s<o.length;s+=1)r+=t(o[s])}return r}(o.responseText);if(""!=r){var s=new Blob([r],{type:"text/vtt"}),i={src:URL.createObjectURL(s),srclang:n.srclang,label:n.label,kind:"subtitles"};""!=a&&(i.mode=a),e.addRemoteTextTrack(i,!0)}}},o.open("GET",n.src,!0),o.send()}function a(t){if("aiovg_videos"==t.post_type){var n={action:"aiovg_update_views_count",post_id:t.post_id,security:aiovg_player.views_nonce};e.post(aiovg_player.ajax_url,n,function(e){})}}window.onmessage=function(t){"aiovg.cookieConsent"==t.data&&e(".aiovg-player-iframe iframe").each(function(){var t=e(this).attr("src");if(-1===t.indexOf("refresh=1")){var n=t.indexOf("?")>-1?"&":"?";e(this).attr("src",t+n+"refresh=1")}})},e(function(){e(".aiovg-player-raw").each(function(){var t;a(e(this).data("params"))}),e(".aiovg-player-standard").each(function(){var t,o,r,s,i,l,c,d,g;o=(t=e(this)).data("id"),r=t.data("params"),s=t.data("src"),i=null,l=function(){var n={action:"aiovg_set_cookie",security:aiovg_player.ajax_nonce};e.post(aiovg_player.ajax_url,n,function(n){n.success&&(c(),t.find(".aiovg-privacy-wrapper").remove(),e(".aiovg-player-standard").trigger("aiovg.cookieConsent",{id:o}))})},c=function(){if("iframe"==r.type)e("#"+o).replaceWith('<iframe src="'+s+'" width="560" height="315" frameborder="0" scrolling="no" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>'),a(r);else{r.player.html5={vhs:{overrideNative:!videojs.browser.IS_ANY_SAFARI}},i=videojs(o,r.player);var l=[],c={id:o,config:r,player:i};t.trigger("player.init",c),i.ready(function(){t.removeClass("vjs-waiting")}),i.one("loadedmetadata",function(){if(t.find(".vjs-quality-selector .vjs-menu-item").each(function(t){var n=e(this),a=n.find(".vjs-menu-item-text").html().replace(/\D/g,"");a>=2160?n.append('<span class="vjs-quality-menu-item-sub-label">4K</span>'):a>=720&&n.append('<span class="vjs-quality-menu-item-sub-label">HD</span>')}),r.hasOwnProperty("tracks"))for(var a=0,o=r.tracks.length;a<o;a++){var s=r.tracks[a],l="";if(0==a&&1==r.cc_load_policy&&(l="showing"),/srt/.test(s.src.toLowerCase()))n(i,s,l);else{var c={src:s.src,srclang:s.srclang,label:s.label,kind:"subtitles"};""!=l&&(c.mode=l),i.addRemoteTextTrack(c,!0)}}});var p=!1;i.on("play",function(t){p||(p=!0,a(r)),e(".aiovg-player-standard").trigger("aiovg.playRequested",{id:o})}),t.on("aiovg.playRequested",function(e,t){o!=t.id&&i.pause()}),i.on("playing",function(){i.trigger("controlsshown")}),i.on("ended",function(){i.trigger("controlshidden")}),i.on("qualitySelected",function(e,t){var n=t.label.replace(/\D/g,"");i.removeClass("vjs-4k"),i.removeClass("vjs-hd"),n>=2160?i.addClass("vjs-4k"):n>=720&&i.addClass("vjs-hd")});var f=i.src();(/.m3u8/.test(f)||/.mpd/.test(f))&&-1!==r.player.controlBar.children.indexOf("qualitySelector")&&i.qualityMenu();var u={};if(r.start&&(u.start=r.start),r.end&&(u.end=r.end),Object.keys(u).length>1&&(u.restart_beginning=!1,i.offset(u)),(r.share||r.embed)&&l.push({content:'<a href="javascript:void(0)" class="vjs-share-embed-button" style="text-decoration:none;"><span class="vjs-icon-share"></span></a>',class:"vjs-share",align:"top-right",start:"controlsshown",end:"controlshidden",showBackground:!1}),r.download){var v="vjs-download";(r.share||r.embed)&&(v+=" vjs-has-share"),l.push({content:'<a href="'+r.download_url+'" class="vjs-download-button" style="text-decoration:none;" target="_blank"><span class="aiovg-icon-download"></span></a>',class:v,align:"top-right",start:"controlsshown",end:"controlshidden",showBackground:!1})}if(r.show_logo&&d(l),l.length>0){if(i.overlay({content:"",overlays:l}),r.share||r.embed){var c={};c.content=t.find(".vjs-share-embed").get(0),c.temporary=!1;var h=new(videojs.getComponent("ModalDialog"))(i,c);h.addClass("vjs-modal-dialog-share-embed"),i.addChild(h);var m=!0;t.find(".vjs-share-embed-button").on("click",function(){m=!i.paused,h.open()}),h.on("modalclose",function(){m&&i.play()})}r.embed&&t.find(".vjs-copy-embed-code").on("focus",function(){e(this).select(),document.execCommand("copy")})}r.copyright_text&&g()}},d=function(e){var t,n=[];switch(n.src=r.logo_image,r.logo_margin&&(r.logo_margin=r.logo_margin-5),r.logo_position){case"topleft":t="top-left",n.style="margin: "+r.logo_margin+"px;";break;case"topright":t="top-right",n.style="margin: "+r.logo_margin+"px;";break;case"bottomright":t="bottom-right",n.style="margin: "+r.logo_margin+"px;";break;default:t="bottom-left",n.style="margin: "+r.logo_margin+"px;"}r.logo_link&&(n.onclick="window.location.href='"+r.logo_link+"';"),e.push({content:"<img "+function e(t){var n="";for(var a in t)n+=a+'="'+t[a]+'" ';return n}(n)+' alt="" />',class:"vjs-logo",align:t,start:"controlsshown",end:"controlshidden",showBackground:!1})},g=function(){e("#aiovg-contextmenu").length||e("body").append('<div id="aiovg-contextmenu" style="display: none;"><div class="aiovg-contextmenu-content">'+r.copyright_text+"</div></div>");var t=document.getElementById("aiovg-contextmenu"),n="";e("#"+o).on("contextmenu",function(e){if(3===e.keyCode||3===e.which){e.preventDefault(),e.stopPropagation();var a=t.offsetWidth,o=t.offsetHeight,r=e.pageX,s=e.pageY,i=document.documentElement,l=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),c=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),d=r+a>window.innerWidth+l?r-a:r,g=s+o>window.innerHeight+c?s-o:s;t.style.display="",t.style.left=d+"px",t.style.top=g+"px",clearTimeout(n),n=setTimeout(function(){t.style.display="none"},1500)}}),document.addEventListener("click",function(){t.style.display="none"})},r.show_consent?(t.find(".aiovg-privacy-consent-button").on("click",function(){e(this).html("..."),"iframe"!=r.type&&(r.player.autoplay=!0),l()}),t.on("aiovg.cookieConsent",function(e,n){o!=n.id&&(c(),t.find(".aiovg-privacy-wrapper").remove())})):c()}),"undefined"!=typeof videojs&&videojs.hook("beforeerror",function(e,t){var n=e.error();if(null===t)return n;if(2==t.code||4==t.code){var a=e.src();if(/.m3u8/.test(a)||/.mpd/.test(a))return{code:t.code,message:aiovg_player.i18n.stream_not_found}}return t})})}(jQuery);
