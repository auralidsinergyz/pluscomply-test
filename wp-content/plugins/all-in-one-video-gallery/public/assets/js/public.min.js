!function(e){"use strict";e(function(){e(".aiovg-autocomplete").each(function(){var t=e(this).data("uid"),a=[];e("option","#aiovg-autocomplete-select-"+t).each(function(){a.push({value:e(this).val(),label:e(this).text()})}),0==a.length&&a.push({value:0,label:aiovg_public.i18n.no_tags_found});var o=function(a,o){if(0!=(a=parseInt(a))){var i=e("#aiovg-autocomplete-tags-"+t);if(0==i.find(".aiovg-tag-item-"+a).length){var n='<span class="aiovg-tag-item aiovg-tag-item-'+a+'">';n+='<span class="aiovg-tag-item-name">'+o+"</span>",n+='<span class="aiovg-tag-item-close">&times;</span>',n+='<input type="hidden" name="ta[]" value="'+a+'" />',n+="</span>",i.append(n)}}};!function e(t,a,o){var i,n=document.getElementById("aiovg-autocomplete-input-"+t);function s(e){if(!e)return!1;(function e(t){for(var a=0;a<t.length;a++)t[a].classList.remove("aiovg-autocomplete-active")})(e),i>=e.length&&(i=0),i<0&&(i=e.length-1),e[i].classList.add("aiovg-autocomplete-active")}function l(e){var s,l,r,g=document.getElementById("aiovg-autocomplete-tags-"+t),u=e.value;for(c(),i=-1,(s=document.createElement("DIV")).setAttribute("id","aiovg-autocomplete-items-"+t),s.setAttribute("class","aiovg-autocomplete-items"),e.parentNode.appendChild(s),r=0;r<a.length;r++){var d=a[r].value,v=a[r].label,p=!1;u?-1!==v.toUpperCase().indexOf(u.toUpperCase())&&(p=!0):p=!0,l||p||r!=a.length-1||(d=0,v=aiovg_public.i18n.no_tags_found,p=!0),p&&((l=document.createElement("DIV")).setAttribute("data-value",d),l.setAttribute("data-label",v),l.innerHTML+=v,g.getElementsByClassName("aiovg-tag-item-"+d).length>0&&l.setAttribute("class","aiovg-autocomplete-selected"),l.addEventListener("click",function(e){n.value="",o(this.getAttribute("data-value"),this.getAttribute("data-label")),c()}),s.appendChild(l))}}function c(e){var t=document.getElementsByClassName("aiovg-autocomplete-items"),a=0;e&&e.id&&(a=e.id.replace("aiovg-autocomplete-input-",""));for(var o=0;o<t.length;o++)t[o].getAttribute("id")!="aiovg-autocomplete-items-"+a&&t[o].parentNode.removeChild(t[o])}n.addEventListener("keydown",function(e){var a=document.getElementById("aiovg-autocomplete-items-"+t);a&&(a=a.getElementsByTagName("div")),40==e.keyCode?(i++,s(a)):38==e.keyCode?(i--,s(a)):13==e.keyCode&&(e.preventDefault(),i>-1&&a&&a[i].click())}),n.addEventListener("focus",function(e){""==e.target.value&&l(e.target)}),n.addEventListener("input",function(e){l(e.target)}),aiovg_public.hasOwnProperty("autocomplete")||(aiovg_public.autocomplete=!0,document.addEventListener("click",function(e){c(e.target)}))}(t,a,o)}),e(document).on("click",".aiovg-tag-item-close",function(){e(this).parent().remove()}),e("select",".aiovg-categories-template-dropdown").on("change",function(){0===parseInt(this.options[this.selectedIndex].value)?window.location.href=e(this).closest(".aiovg-categories-template-dropdown").data("uri"):window.location.href=this.options[this.selectedIndex].getAttribute("data-uri")}),e(document).on("click",".aiovg-pagination-ajax a.page-numbers",function(t){t.preventDefault();var a=e(this),o=a.closest(".aiovg-pagination-ajax"),i=parseInt(o.data("current")),n=o.data("params");n.action="aiovg_load_more_"+n.source,n.security=aiovg_public.ajax_nonce;var s=parseInt(a.html());n.paged=s++,a.hasClass("prev")&&(n.paged=i-1),a.hasClass("next")&&(n.paged=i+1);var l=e("#aiovg-"+n.uid);o.addClass("aiovg-spinner"),e.post(aiovg_public.ajax_url,n,function(t){t.success?(l.html(e(t.data.html).html()).trigger("AIOVG.onGalleryUpdated"),e("html, body").animate({scrollTop:l.offset().top-aiovg_public.scroll_to_top_offset},500)):o.removeClass("aiovg-spinner")})}),e(document).on("click",".aiovg-more-ajax button",function(t){t.preventDefault();var a=e(this),o=a.closest(".aiovg-more-ajax"),i=parseInt(a.data("numpages")),n=o.data("params");n.action="aiovg_load_more_"+n.source,n.security=aiovg_public.ajax_nonce;var s=parseInt(a.data("paged"));n.paged=++s,o.addClass("aiovg-spinner"),e.post(aiovg_public.ajax_url,n,function(t){o.removeClass("aiovg-spinner"),s<i?a.data("paged",n.paged):a.hide(),t.success&&e(".aiovg-grid","#aiovg-"+n.uid).append(e(".aiovg-grid",t.data.html).html())})})})}(jQuery);
