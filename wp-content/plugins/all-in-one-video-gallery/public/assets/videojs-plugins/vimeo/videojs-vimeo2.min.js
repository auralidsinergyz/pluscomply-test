/*! @name @Plugins360/videojs-vimeo2 @version 2.0.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsVimeo2=t(e.videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=t(e);function o(e,t,i){return e(i={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&i.path)}},i.exports),i.exports}var r,s,a,n,u,l,c,d,h=o((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0})),p=o((function(e){function t(i,o){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(i,o)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),m=o((function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0})),v=i.default.getComponent("Tech"),y=i.default.browser.IS_NATIVE_ANDROID,f=function(e){function t(i,o){var r;return(r=e.call(this,i,o)||this)._vimeoState={state:"unstarted",volume:1,muted:!!r.options_.muted,muteVolume:1,buffered:0,currentTime:0,duration:0,playbackRate:1},r.setPoster(i.poster),r.setSrc(r.options_.source),r.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-vimeo",y&&(this.el_.parentNode.className+=" vjs-vimeo-mobile"),t.isApiReady?this.initVimeoPlayer():t.apiReadyQueue.push(this))}.bind(h(r))),r}m(t,e);var o=t.prototype;return o.dispose=function(){if(this.vimeoPlayer)this.vimeoPlayer.unload(),this.vimeoPlayer.destroy();else{var i=t.apiReadyQueue.indexOf(this);-1!==i&&t.apiReadyQueue.splice(i,1)}this.vimeoPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-vimeo","").replace(" vjs-vimeo-mobile",""),this.el_.parentNode.removeChild(this.el_),e.prototype.dispose.call(this)},o.createEl=function(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),e.setAttribute("class","vjs-tech");var t=document.createElement("div");if(t.appendChild(e),!y&&!this.options_.vimeoControls){var i=document.createElement("div");i.setAttribute("class","vjs-iframe-blocker"),i.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),t.appendChild(i)}return t},o.initVimeoPlayer=function(){var e=this,t={url:this.options_.source.src,byline:!1,controls:!1,portrait:!1,title:!1};if(void 0!==this.options_.byline&&(t.byline=!!this.options_.byline),void 0!==this.options_.color&&(t.color=this.options_.color.replace(/^#/,"")),void 0!==this.options_.vimeoControls&&(t.controls=!!this.options_.vimeoControls),void 0!==this.options_.muted&&(t.muted=!!this.options_.muted),void 0!==this.options_.loop&&(t.loop=!!this.options_.loop),void 0!==this.options_.playsinline&&(t.playsinline=!!this.options_.playsinline),void 0!==this.options_.portrait&&(t.portrait=!!this.options_.portrait),void 0!==this.options_.title&&(t.title=!!this.options_.title),void 0!==this.options_.customVars){var i=this.options_.customVars;Object.keys(i).forEach((function(e){t[e]=i[e]}))}this.activeVideoId=this.url?this.url.videoId:null,this.vimeoPlayer=new Vimeo.Player(this.options_.techId,t),this.trigger("loadstart"),this.vimeoPlayer.ready().then((function(){e.onPlayerReady();["play","playing","pause","ended","bufferstart","waiting","progress","timeupdate","seeking","seeked","durationchange","volumechange","playbackratechange","error"].forEach((function(t){e.vimeoPlayer.on(t,(function(i){return e.onPlayerStateChange(t,i)}))}))}))},o.onPlayerReady=function(){this.isReady_=!0,this.triggerReady(),this.trigger("loadedmetadata"),this.trigger("loadeddata"),this.trigger("canplay"),this.trigger("canplaythrough"),this.trigger("volumechange"),this.trigger("ratechange"),this.playOnReady&&this.play()},o.onPlayerStateChange=function(e,t){switch(this.lastState=e,e){case"play":this._vimeoState.state="play",this.trigger("play");break;case"playing":this._vimeoState.state="playing",this.trigger("playing");break;case"pause":this._vimeoState.state="paused",this.trigger("pause");break;case"ended":this._vimeoState.state="ended",this.trigger("ended");break;case"bufferstart":case"waiting":this._vimeoState.state="buffering",this.trigger("play"),this.trigger("waiting");break;case"progress":this._vimeoState.buffered=t.percent,this.trigger("progress");break;case"timeupdate":this._vimeoState.currentTime=t.seconds,this.trigger("timeupdate");break;case"seeking":this.isSeeking=!0,this.trigger("seeking");break;case"seeked":this.isSeeking=!1,this.trigger("seeked");break;case"durationchange":this._vimeoState.duration=t.duration,this.trigger("durationchange");break;case"volumechange":this.trigger("volumechange");break;case"playbackratechange":this._vimeoState.playbackRate=t.playbackRate,this.trigger("ratechange");break;case"error":"PlayInterrupted"==t.name&&(this._vimeoState.state="paused",this.trigger("pause")),console.log(t)}},o.error=function(){return{code:null,message:null}},o.poster=function(){return y?null:this.poster_},o.setPoster=function(e){this.poster_=e},o.loadVideoById_=function(e){var t=this;this.vimeoPlayer&&this.vimeoPlayer.loadVideo(e).then((function(e){t.play()}))},o.cueVideoById_=function(e){this.vimeoPlayer&&this.vimeoPlayer.loadVideo(e)},o.src=function(e){return e&&this.setSrc({src:e}),this.source},o.setSrc=function(e){e&&e.src&&(this.source=e,this.url=t.parseUrl(e.src),this.options_.autoplay&&!y?this.isReady_?this.play():(this.trigger("waiting"),this.playOnReady=!0):this.activeVideoId!==this.url.videoId&&(this.isReady_?(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):this.cueOnReady=!0))},o.autoplay=function(){return this.options_.autoplay},o.setAutoplay=function(e){this.options_.autoplay=e},o.loop=function(){return this.options_.loop},o.setLoop=function(e){this.options_.loop=e},o.play=function(){this.url&&this.url.videoId&&(this.isReady_?this.activeVideoId===this.url.videoId?this.vimeoPlayer.play().then((function(){})).catch((function(e){})):(this.loadVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):(this.trigger("waiting"),this.playOnReady=!0))},o.pause=function(){this.vimeoPlayer&&this.vimeoPlayer.pause()},o.paused=function(){return"playing"!==this._vimeoState.state&&"buffering"!==this._vimeoState.state},o.currentTime=function(){return this._vimeoState.currentTime},o.setCurrentTime=function(e){var t=this;this.vimeoPlayer&&(this._vimeoState.currentTime=e,this.vimeoPlayer.setCurrentTime(e).then((function(){t._vimeoState.currentTime=e})))},o.seeking=function(){return this.isSeeking},o.seekable=function(){return i.default.createTimeRange(0,this._vimeoState.duration)},o.playbackRate=function(){return this._vimeoState.playbackRate},o.setPlaybackRate=function(e){var t=this;this.vimeoPlayer&&this.vimeoPlayer.setPlaybackRate(e).then((function(e){t._vimeoState.playbackRate=e}))},o.duration=function(){return this._vimeoState.duration},o.currentSrc=function(){return this.source&&this.source.src},o.ended=function(){return!!this.vimeoPlayer&&"ended"===this._vimeoState.state},o.volume=function(){return this._vimeoState.muted?this._vimeoState.muteVolume:this._vimeoState.volume},o.setVolume=function(e){var t=this;this.vimeoPlayer&&("unstarted"==this._vimeoState.state&&this._vimeoState.muted||this.vimeoPlayer.setVolume(e).then((function(){t._vimeoState.volume=e})))},o.muted=function(){return!!this.vimeoPlayer&&this._vimeoState.muted},o.setMuted=function(e){this.vimeoPlayer&&(e?(this._vimeoState.muteVolume=this._vimeoState.volume,this.setVolume(0)):this.setVolume(this._vimeoState.muteVolume),this._vimeoState.muted=e)},o.buffered=function(){return i.default.createTimeRange(0,this._vimeoState.buffered*this._vimeoState.duration)},o.supportsFullScreen=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled},o.networkState=function(){if(!this.vimeoPlayer)return 0;switch(this._vimeoState.state){case"unstarted":return 0;case"buffering":return 2;default:return 1}},o.readyState=function(){if(!this.vimeoPlayer)return 0;switch(this._vimeoState.state){case"unstarted":return 0;case"ready":return 1;case"buffering":return 2;default:return 4}},t}(v);return f.prototype.featuresTimeupdateEvents=!0,f.prototype.featuresPlaybackRate=!0,f.isSupported=function(){return!0},f.parseUrl=function(e){var t={videoId:null},i=e.match(/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/);return i&&(t.videoId=i[5]),t},v.withSourceHandlers(f),f.nativeSourceHandler={},f.nativeSourceHandler.canPlayType=function(e){return"video/vimeo"===e?"maybe":""},f.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return f.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=/vimeo.com/.test(e.src)?"video/vimeo":"";return f.nativeSourceHandler.canPlayType(i)}return""},f.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},f.nativeSourceHandler.dispose=function(){},f.registerSourceHandler(f.nativeSourceHandler),f.apiReadyQueue=[],"undefined"!=typeof document&&(n="https://player.vimeo.com/api/player.js",u=function(){f.isApiReady=!0;for(var e=0;e<f.apiReadyQueue.length;++e)f.apiReadyQueue[e].initVimeoPlayer()},l=!1,c=document.createElement("script"),(d=document.getElementsByTagName("script")[0]).parentNode.insertBefore(c,d),c.onload=function(){l||(l=!0,u())},c.onreadystatechange=function(){l||"complete"!==this.readyState&&"loaded"!==this.readyState||(l=!0,u())},c.src=n,r=".vjs-vimeo iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }.vjs-vimeo .vjs-iframe-blocker { display: none; }.vjs-vimeo.vjs-has-started .vjs-iframe-blocker { display: block; }.vjs-vimeo .vjs-poster { background-size: cover; }",s=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r)),s.appendChild(a)),f.VERSION="2.0.0",v.registerTech("Vimeo2",f),f}));
